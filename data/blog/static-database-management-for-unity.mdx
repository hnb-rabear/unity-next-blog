---
title: Excel2Unity - Giải pháp Static Database toàn diện cho mid-hard core game
date: 2023-11-20
lastmod: 2023-11-20
tags: ['unity', 'game development', 'architecture']
images: ['/media/excel-2-unity-tab-1.png']
draft: false
summary: Exel2Unity là công cụ linh hoạt và mạnh mẽ, có khẳ năng đáp ứng đầy đủ cho Coder và Designer trong việc thiết kế và quản lý dữ liệu. Nó giải quyết được hầu hết các tình huống liên quan đến thiết kế và quản lý Static Database trong quá trình phát triển game.
language: vn
---

<TOCInline toc={props.toc} />

# 1. Giới thiệu

## Static Database

Static Database trong phát triển game là một giải pháp lưu trữ các dữ liệu tĩnh vd như kỹ năng, vật phẩm, nhân vật mà không thay đổi trong suốt quá trình chơi game. Thay vì đọc dữ liệu từ nguồn động (Dynamic Database) chúng ta sử dụng các phương tiện như ScriptableObject, CSV, hoặc JSON để lưu trữ và quản lý thông tin. Đây là giải pháp nhanh và khá tiện lợi trong quá trình phát triển game.

## Thách thức khi Static Database trở nên quá lớn

Trong quá trình phát triển game, chúng ta thường xuyên đối mặt với những thay đổi, nhiều khi cần mở rộng hoặc thay đổi thiết kế, việc phải điều chỉnh tính năng và cấu trúc cơ sở dữ liệu là không thể tránh khỏi. Sử dụng những phương pháp thông thường như ScriptableObject, CSV hoặc JSON để quản lý Static Database có thể không đủ đáp ứng khi chúng ta đối mặt với hệ thống lớn, như trong các game Mid-core trở lên. Quản lý dữ liệu khổng lồ này mà không có công cụ hỗ trợ là một sự phiền toái.

# 2. Excel to Unity

## Giải pháp toàn diện để xây dựng và quản lý Static Database

Đây là một công cụ linh hoạt và mạnh mẽ, có thể đáp ứng đầy đủ nhu cầu của Coder và Designer trong việc thiết kế và quản lý dữ liệu. Nó có khả năng giải quyết hầu hết các vấn đề liên quan đến thiết kế và quản lý Static Database trong quá trình phát triển game.

Các chức năng bao gồm:

- Quản lý Database hoàn toàn bằng Excel.
- Xuất Data Table thành các file txt để dễ dàng tích hợp vào Unity.
- Cung cấp nhiều định dạng dữ liệu, có thể thay đổi linh hoạt theo yêu cầu thiết kế Data.
- Quản lý IDs và Constants một cách hiệu quả, cho phép điều chỉnh hàng loạt mà không ảnh hưởng đến Database.
- Quản lý đa ngôn ngữ dễ dàng thông qua hệ thống Localization, có khả năng kết hợp mạnh mẽ với Unity.
- Và nhiều tính năng nâng cao khác.

## Download

[Download from GitHub](https://github.com/nbhung100914/ExcelToUnity/releases)<br/>
**Nếu công cụ hữu ích cho bạn thì hãy gửi tặng một ⭐ nhé.**

# 3. Công cụ này hoạt động như thế nào

Mọi Static Database

# 4. Giới thiệu tính năng và cách cài đặt

## 4.1. Settings

![Settings](/media/excel-2-unity-tab-3.png)

- **Json Data Output:** Data table sẽ được chuyển đổi thành dạng dạng Json data và lưu tại địa chỉ này.
- **Constants Output:** IDs, Constants, Localization Component và Localization API sẽ được lưu tại đại chỉ này.
- **Localization Ouput:** Data Localization sẽ được lưu tại đại chỉ này. Địa chỉ này nên nằm trong thư mục _Resources_.
- **Namespace:** khai báo namespace cho các file C# mà tool xuất ra.
- **Separate IDs:**
  - TRUE: xuất các sheet _[%IDs]_ thành các file C# độc lập với tên file theo cấu trúc _[SheetName] + IDs.cs_
  - FALSE: tổng hợp tất cả các sheet _[%IDs]_ từ tất cả các file excel thành một rồi xuất thành một file C# duy nhất là _IDs.cs_
- **Separate Constants:**
  - TRUE: xuất các sheet _[%Constants]_ thành các file C# độc lập với tên file theo cấu trúc _[SheetName] + %Constants.cs_
  - FALSE: tổng hợp tất cả các sheet _[%Constants]_ từ tất cả các file excel thành một rồi export thành một file C# duy nhất là _Constants.cs_
- **Separate Localization:**
  - TRUE: xuất các sheet _[%Localization%]_ thành các nhóm độc lập, một nhóm bao gồm Localization Data, Unity Component và API, , tên các file sẽ có cấu trúc sau:
    - Localization Data: _[SheetName]\_[language].txt_
    - Component: _[SheetName] + Text.cs_
    - API: _[SheetName].cs_
  - FALSE: tổng hợp tất cả các sheet _[%Localization%]_ từ tất cả các file excel thành một rồi xuất thành một nhóm duy nhất, tên các file sẽ có cấu trúc sau:
    - Localization Data: _Localization\_ + [language].txt_
    - Component: _LocalizationText.cs_
    - API: _Localization.cs_
- **Encript Json:** mã Json Data trước khi xuất thành text file
- **Only Enum as ID:** áp dụng cho sheet _[%IDs]_, các cột có phần mở rộng là _[enum]_. Nếu chọn thì cột IDs đó sẽ được xuất dưới dạng Enum mà bỏ qua dạng Integer Constant.
- **One Json - One Excel:** tổng hợp Data Table trong một file excel thành một file Json duy nhất, tên file theo cấu trúc _[ExcelName].txt_
- **Encryption Key:** key để mã hóa Json data
- **Language maps:** ứng dụng cho Localization kết hợp TextMeshPro, dùng để tổng hợp bảng ký tự của một ngôn ngữ. Chủ yếu được áp dụng cho Korean, Japanese và Chinese đây là các ngôn ngữ có hệ thống ký tự cực kỳ lớn.
- **Excluded Sheets:** nhập tên các Sheet cần bỏ qua khi xử lý Data Table.
- **Excluded Sheets:** nhập tên các trường cần bị bỏ qua khi xử lý Data Table.

## 4.2. Convert single excel

![Convert Single File](/media/excel-2-unity-tab-1.png)

Đây là một chức năng cơ bản nhưng lại rất quan trọng, giúp bạn làm quen với các công cụ. Nếu Static Database của bạn không quá lớn hoặc phức tạp, và chỉ cần một file excel để chứa tất cả dữ liệu, thì chức năng này là đủ cho nhu cầu của bạn. Tuy nhiên, nếu Static Database của bạn phức tạp và cần được lưu trữ trong nhiều file Excel, bạn sẽ cần sử dụng chức năng **Convert Multi Files**. Chức năng này sẽ được giới thiệu trong phần tiếp theo.

Các chức năng quan trọng nằm ở các nút bên phải:

- **Export Json:** xuất các sheet dạng Data Table thành JSON data.
- **Export IDs:** xuất các sheet dạng IDs thành các file C#.
- **Export Constants:** xuất các sheet dạng Constants thành các file C#.
- **Export Settings:** chức năng này đã lỗi thời và sẽ bị xóa trong tương lai.
- **Export Localization:** xuất Localization Data và Localization Component, Localization API tương ứng.

Thiết lập:

- **Data File:** nhập địa chỉ của file excel chứa Static Database.
- **Separate Constants:** chọn lựa chọn này nếu bạn muốn xuất các sheet _[%IDs]_ và _[%Constants]_ thành các file C# riêng biệt, với tên file theo cấu trúc _[SheetName] + IDs.cs_ và _[SheetName] + Constants.cs_.
- **Encrypt Data:** chọn lựa chọn này nếu bạn muốn mã hóa Json Data được xuất từ Data Table.
- **Merge Jsons:** chọn lựa chọn này nếu bạn muốn xuất toàn bộ Data Table thành một file Json duy nhất. Tên file json sẽ là tên file excel hoặc tên được tùy chỉnh ở TextBox liền kề.

Thông tin hiển thị:

- Bảng ở bên trái hiển thị danh sách các sheet trong file excel.
- Bảng ở giữa hiển thị danh sách id được tổng hợp từ các sheet có tên _[%IDs].cs_.
- Khung cuộn phía dưới sẽ hiển thị log

## 4.3. Convert multi excels (All in one)

![Convert Multi Files (All in one)](/media/excel-2-unity-tab-2.png)

Đây là chức tổng hợp, tất cả sẽ được xử lý chỉ bằng một nút ấn chỉ cần:

1. Chọn tất cả các file excel mà bạn muốn xử lý.
2. Bạn có thể quyết định xuất IDs, Constants hoặc không bằng cách đánh dấu vào CheckBox tương ứng với mỗi file excel.
3. Cuối cùng, hãy nhấn nút Export All.

## 4.4. Encrypt & Decrypt Text

![Convert Multi Files (All in one)](/media/excel-2-unity-tab-4.png)

Chức năng này cho phép bạn mã hóa hoặc giải mã một chuỗi ký tự dựa trên Key được cung cấp trong Tab Settings. Bạn có thể sử dụng chức năng này để bảo mật nội dung của một văn bản, hoặc để mở và đọc các file Json data đã được mã hóa sau khi xuất ra.

# 5. Quy tắc thiết kế data trong Excel

[Download example exel from GitHub](https://github.com/nbhung100914/ExcelToUnity/blob/main/ExcelToUnity/Document/DataConverterExample.xlsx)

# 5.1. IDs

Các sheet có tên theo cú pháp _[%IDs]_ được gọi là IDs sheet. Chúng được sử dụng để tổng hợp tất cả id dưới dạng Constants Integer. Mỗi id được khai báo trong một nhóm bao gồm 3 cột liền nhau: cột 1 là tên, cột 2 là giá trị và cột 3 là chú thích. Ví dụ dưới đây minh họa cho 3 nhóm id: Hero Id, Building Id và Pet Id.

| Hero   |     |         | Building      |     |         | Pet      |     |         |
| ------ | --- | ------- | ------------- | --- | ------- | -------- | --- | ------- |
| HERO_1 | 1   | comment | BUILDING_NULL | 0   | comment | PET_NULL | -1  | comment |
| HERO_2 | 2   | comment | BUILDING_1    | 1   |         | PET_1    | 0   |         |
| HERO_3 | 3   | comment | BUILDING_2    | 2   |         | PET_2    | 1   |         |
| HERO_4 | 4   | comment | BUILDING_3    | 3   |         | PET_3    | 2   |         |
| HERO_5 | 5   | comment | BUILDING_4    | 4   |         | PET_4    | 3   |         |
|        |     |         | BUILDING_5    | 5   |         | PET_5    | 4   |         |
|        |     |         | BUILDING_6    | 6   |         | PET_6    | 5   |         |
|        |     |         | BUILDING_7    | 7   |         | PET_7    | 6   |         |
|        |     |         | BUILDING_8    | 8   |         |          |     |         |

# 5.2. Constants

Các sheet được đặt tên theo cú pháp _[%Constants]_ được gọi là Constants Sheet. Chúng được sử dụng để tổng hợp lại các Constants trong project. Bảng dưới đây sẽ giúp bạn tham khảo được tất cả các kiểu dữ liệu mà có thể dùng trong sheet này.

| Name                  | Type        | Value            | Comment                              |
| --------------------- | ----------- | ---------------- | ------------------------------------ |
| EXAMPLE_INT           | int         | 83               | Write your comment for the constants |
| EXAMPLE_FLOAT         | float       | 1.021            | Write your comment for the constants |
| EXAMPLE_STRING        | string      | 321fda           | Write your comment for the constants |
| EXAMPLE_INT_ARRAY_1   | int-array   | 4                | Write your comment for the constants |
| EXAMPLE_INT_ARRAY_2   | int-array   | 0:3:4:5          | Write your comment for the constants |
| EXAMPLE_FLOAT_ARRAY_1 | float-array | 5                | Write your comment for the constants |
| EXAMPLE_FLOAT_ARRAY_2 | float_array | 5:1:1:3          | Write your comment for the constants |
| EXAMPLE_VECTOR2_1     | vector2     | 1:2              | Write your comment for the constants |
| EXAMPLE_VECTOR2_2     | vector2     | 1:2:3            | Write your comment for the constants |
| EXAMPLE_VECTOR3       | vector3     | 3:3:4            | Write your comment for the constants |
| EXAMPLE_REFERENCE_1   | int         | HERO_1           | Write your comment for the constants |
| EXAMPLE_REFERENCE_2   | int-array   | HERO_1 : HERO_2  | Write your comment for the constants |
| EXAMPLE_REFERENCE_3   | int-array   | HERO_1 \| HERO_3 | Write your comment for the constants |
| EXAMPLE_REFERENCE_4   | int-array   | HERO_1 HERO_4    | Write your comment for the constants |
| EXAMPLE_FORMULA_1     | int         | 360              | Write your comment for the constants |
| EXAMPLE_FORMULA_2     | float       | 45               | Write your comment for the constants |

# 5.3. Localization

Các sheet được đặt tên theo cú pháp _[%Localization%]_ được gọi là Localization Sheet.

| idstring     | relativeId | english                   | spanish                        |
| ------------ | ---------- | ------------------------- | ------------------------------ |
| message_1    |            | this is english message 1 | este es el mensaje en ingles 1 |
| message_2    |            | this is english message 2 | este es el mensaje en ingles 2 |
| message_3    |            | this is english message 3 | este es el mensaje en ingles 3 |
| message_4    |            | this is english message 4 | este es el mensaje en ingles 4 |
| message_5    |            | this is english message 5 | este es el mensaje en ingles 5 |
|              |            |                           |                                |
| Content      | 1          | this is english message 1 | este es el mensaje en ingles 1 |
| Content      | 2          | this is english message 2 | este es el mensaje en ingles 2 |
| Content      | 3          | this is english message 3 | este es el mensaje en ingles 3 |
| Content      | 4          | this is english message 4 | este es el mensaje en ingles 4 |
| Content      | 5          | this is english message 5 | este es el mensaje en ingles 5 |
|              |            |                           |                                |
| title_1      |            | this is english title 1   | este es el titulo 1 en ingles  |
| title_2      |            | this is english title 2   | este es el titulo 2 en ingles  |
| title_3      |            | this is english title 3   | este es el titulo 3 en ingles  |
| title_4      |            | this is english title 4   | este es el titulo 4 en ingles  |
| title_5      |            | this is english title 5   | este es el titulo 5 en ingles  |
| title_6      |            | this is english title 6   | este es el titulo 6 en ingles  |
|              |            |                           |                                |
| whatever_msg |            | this is a sample message  | este es un mensaje de muestra  |
|              |            |                           |                                |
| hero_name    | HERO_1     | hero name 1               | nombre del héroe 1             |
| hero_name    | HERO_2     | hero name 2               | nombre del héroe 2             |
| hero_name    | HERO_3     | hero name 3               | nombre del héroe 3             |
| hero_name    | HERO_4     | hero name 4               | nombre del héroe 4             |
| hero_name    | HERO_5     | hero name 5               | nombre del héroe 5             |
