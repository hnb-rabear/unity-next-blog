---
title: Giải pháp xây dựng Static Database toàn diện cho một game mid-hard core
date: 2023-11-20
lastmod: 2023-11-20
tags: ['unity', 'game development', 'architecture']
images: ['/media/excel-2-unity-tab-1.png']
draft: false
summary: Exel2Unity là công cụ linh hoạt và mạnh mẽ, có khẳ năng đáp ứng đầy đủ cho Coder và Designer trong việc thiết kế và quản lý dữ liệu. Nó giải quyết được hầu hết các tình huống liên quan đến thiết kế và quản lý Static Database trong quá trình phát triển game.
language: vn
---

## 1. Static Database

Static Database trong phát triển game là một giải pháp lưu trữ các dữ liệu tĩnh vd như kỹ năng, vật phẩm, nhân vật mà không thay đổi trong suốt quá trình chơi game. Thay vì đọc dữ liệu từ nguồn động (Dynamic Database) chúng ta sử dụng các phương tiện như ScriptableObject, CSV, hoặc JSON để lưu trữ và quản lý thông tin. Đây là giải pháp nhanh và khá tiện lợi trong quá trình phát triển game.

## 2. Thách thức khi Static Database trở nên quá lớn

Trong quá trình phát triển game, chúng ta thường xuyên đối mặt với những thay đổi, nhiều khi cần mở rộng hoặc thay đổi thiết kế, việc phải điều chỉnh tính năng và cấu trúc cơ sở dữ liệu là không thể tránh khỏi. Sử dụng những phương pháp thông thường như ScriptableObject, CSV hoặc JSON để quản lý Static Database có thể không đủ đáp ứng khi chúng ta đối mặt với hệ thống lớn, như trong các game Mid-core trở lên. Quản lý dữ liệu khổng lồ này mà không có công cụ hỗ trợ là một sự phiền toái.

## 3. Excel to Unity - Giải pháp toàn diện để xây dựng và quản lý Static Database

Đây là công cụ linh hoạt và mạnh mẽ, có khẳ năng đáp ứng đầy đủ cho Coder và Designer trong việc thiết kế và quản lý dữ liệu. Nó giải quyết được hầu hết các tình huống liên quan đến thiết kế và quản lý Static Database trong quá trình phát triển game.

Các chức năng bao gồm:

- Database được quản lý hoàn toàn bằng Excel
- Data Table được xuất thành dạng text files để để tích hợp dễ dàng vào Unity.
- Biểu diễn data theo dạng bảng, có nhiều tùy chỉnh đa dạng, thay đổi linh hoạt tùy theo thiết kế.
- Quản lý IDs và Constants một cách hiệu quả, dễ dàng điều chỉnh hàng loạt mà không ảnh hưởng đến Database.
- Quản lý đa ngôn ngữ dễ dang thông qua hệ thống Localization, có sự kết hợp mạnh mẽ với Unity.
- Và còn nhiều tính năng khác nâng cao khác.

## 4. Download

[Download from GitHub](https://github.com/nbhung100914/ExcelToUnity/releases)<br/>
**Nếu công cụ hữu ích cho bạn thì hãy gửi tặng một ⭐ nhé.**

## 5. Ví dụ thực tiễn và cách thức hoạt động

## 6. Hướng dẫn sử dụng

### 6.1. Quy ước đặt tên

### 6.2. Settings

![Settings](/media/excel-2-unity-tab-3.png)

- **Json Data Output:** Data table sẽ được chuyển đổi thành dạng dạng json data và lưu tại địa chỉ này.
- **Constants Output:** IDs, Constants, Localization Component và Localization API sẽ được lưu tại đại chỉ này.
- **Localization Ouput:** Data Localization sẽ được lưu tại đại chỉ này. Địa chỉ này nên nằm trong thư mục _Resources_.
- **Namespace:** khai báo namespace cho các file C# mà tool xuất ra.
- **Separate IDs:**
  - TRUE: xuất các sheet _[%IDs]_ thành các file C# độc lập với tên file theo cấu trúc _[SheetName] + IDs.cs_
  - FALSE: tổng hợp tất cả các sheet _[%IDs]_ từ tất cả các file excel thành một rồi xuất thành một file C# duy nhất là _IDs.cs_
- **Separate Constants:**
  - TRUE: xuất các sheet _[%Constants]_ thành các file C# độc lập với tên file theo cấu trúc _[SheetName] + %Constants.cs_
  - FALSE: tổng hợp tất cả các sheet _[%Constants]_ từ tất cả các file excel thành một rồi export thành một file C# duy nhất là _Constants.cs_
- **Separate Localization:**
  - TRUE: xuất các sheet _[%Localization%]_ thành các nhóm độc lập, một nhóm bao gồm Localization Data, Unity Component và API, , tên các file sẽ có cấu trúc sau:
    - Localization Data: _[SheetName]\_[language].txt_
    - Component: _[SheetName] + Text.cs_
    - API: _[SheetName].cs_
  - FALSE: tổng hợp tất cả các sheet _[%Localization%]_ từ tất cả các file excel thành một rồi xuất thành một nhóm duy nhất, tên các file sẽ có cấu trúc sau:
    - Localization Data: _Localization\_ + [language].txt_
    - Component: _LocalizationText.cs_
    - API: _Localization.cs_
- **Encript Json:** mã Json Data trước khi xuất thành text file
- **Only Enum as ID:** áp dụng cho sheet _[%IDs]_, các cột có phần mở rộng là _[enum]_. Nếu chọn thì cột IDs đó sẽ được xuất dưới dạng Enum mà bỏ qua dạng Integer Constant.
- **One Json - One Excel:** tổng hợp Data Table trong một file excel thành một file Json duy nhất, tên file theo cấu trúc _[ExcelName].txt_
- **Encryption Key:** key để mã hóa Json data
- **Language maps:** ứng dụng cho Localization kết hợp TextMeshPro, dùng để tổng hợp bảng ký tự của một ngôn ngữ. Chủ yếu được áp dụng cho Korean, Japanese và Chinese đây là các ngôn ngữ có hệ thống ký tự cực kỳ lớn.
- **Excluded Sheets:** nhập tên các Sheet cần bị bỏ qua khi xử lý.
- **Excluded Sheets:** nhập tên các trường trong Data Table cần bị bỏ qua khi xử lý.

### 6.3. Convert Single file

![Convert Single File](/media/excel-2-unity-tab-1.png)

Đây là chức năng cơ bản nhất để bạn có thể làm quen với công cụ để hiểu cách sử dụng nó. Nếu Static Database không quá lớn, và đủ lưu tất cả vào trong một file Excel thì bạn có thể dùng chức năng này. Ngược lại, nếu Static Database được lưu trữ trong nhiều file Excel khác nhau thì nên sử dụng chức năng **Convert Multi Files**, chức năng này sẽ được giới thiệu trong mục kế tiếp.

Các chức năng quan trọng nằm ở các nút bên phải:

- **Export Json:** xuất các sheet dạng Data Table thành JSON data.
- **Export IDs:** xuất các sheet dạng IDs thành các file C#.
- **Export Constants:** xuất các sheet dạng Constants thành các file C#.
- **Export Settings:** chức năng này đã lỗi thời và sẽ bị xóa trong tương lai.
- **Export Localization:** xuất Localization Data và Localization Component, Localization API tương ứng.

Thiết lập:

- **Data File:** điền địa chỉ của file excel chứa Static Database.
- **Separate Constants:** chọn, nếu muốn xuất các sheet _[%IDs]_ và _[%Constants]_ thành các file C# độc lập với tên file theo cấu trúc _[SheetName] + IDs.cs_ và [SheetName] + Constants.cs.
- **Encrypt Data:** chọn, nếu muốn mã hóa Json Data được xuất từ Data Table.
- **Merge Jsons:** chọn, nếu muốn xuất toàn bộ Data Table thành một file Json duy nhất. Tên file json sẽ là tên file excel hoặc tên được tùy chỉnh ở TextBox liền kề.

Thông tin hiển thị:

- Bảng trái hiển thị các sheet trong file excel.
- Bảng giữa hiển thị danh sách integer id được tổng hợp từ các sheet _[%IDs].cs_.
- Khung cuộn cuối cùng sẽ hiển thị log

### 6.4. Convert Multi Files (All in one)

![Convert Multi Files (All in one)](/media/excel-2-unity-tab-2.png)

Đây là chức tổng hợp, tất cả được xử lý chỉ bằng một nút ấn.
